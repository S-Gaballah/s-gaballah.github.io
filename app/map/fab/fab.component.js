System.register(["@angular/core","../map.service","../visualization.service","esri/dijit/BasemapGallery","rxjs/add/observable/fromEvent"],function(e,t){"use strict";var i,a,n,s,o,r=this&&this.__decorate||function(e,t,i,a){var s,o=arguments.length,n=o<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,a);else for(var r=e.length-1;0<=r;r--)(s=e[r])&&(n=(o<3?s(n):3<o?s(t,i,n):s(t,i))||n);return 3<o&&n&&Object.defineProperty(t,i,n),n},p=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};t&&t.id;return{setters:[function(e){i=e},function(e){a=e},function(e){n=e},function(e){s=e},function(e){}],execute:function(){o=function(){function e(e,t,i){this.visualization=e,this.mapService=t,this.cdr=i,this.isBasemapOpen=!1,this.isEditToolbarOpen=!1,this.isTracking=!1,this.isHeatmap=!1,this.offsetX=0,this.offestY=25}return e.prototype.trackPoint=function(){var o=this;this.mapService.IsConnected&&(this.isTracking=!this.isTracking,this.isTracking?this.graphicLayerClickHandler=this.mapService.VehiclesLayer.on("click",function(e){o.mapService.TrackingPoint&&o.mapService.TrackingPoint.setSymbol(null);var t=o.visualization.Color([0,77,168,.7]),i=o.visualization.Color([255,0,0,.78]),a=o.visualization.SimpleLineSymbol(n.SimpleLineSymbolStyle.STYLE_SOLID,t),s=o.visualization.SimpleSVGSymbol("M14.5,29 23.5,0 14.5,9 5.5,0z",a,i,27,e.graphic.attributes.Heading);e.graphic.setSymbol(s),o.mapService.Map.centerAndZoom(e.graphic.geometry,17),o.mapService.TrackingPoint=e.graphic}):(this.mapService.VehiclesLayer.enableMouseEvents(),this.mapService.GoHome(),this.mapService.TrackingPoint=null,this.graphicLayerClickHandler&&this.graphicLayerClickHandler.remove()))},e.prototype.reset=function(){this.mapService.GoHome(),this.mapService.TrackingPoint=null,this.isTracking=!1,this.isHeatmap=!1},e.prototype.connect=function(){this.mapService.IsConnected=!this.mapService.IsConnected,this.mapService.IsConnected?this.mapService.addVehiclesLayer():(this.mapService.removeVehiclesLayer(),this.reset())},e.prototype.Identify=function(){},e.prototype.enableHeatmap=function(){this.mapService.IsConnected&&(this.isHeatmap=!this.isHeatmap,this.isHeatmap?(this.mapService.VehiclesLayer.setVisibility(!1),this.mapService.HeatmapLayer.setVisibility(!0)):(this.mapService.VehiclesLayer.setVisibility(!0),this.mapService.HeatmapLayer.setVisibility(!1)))},e.prototype.FullExtent=function(){this.mapService.GoHome()},e.prototype.ZoomIn=function(){this.mapService.Map.setLevel(this.mapService.Map.getLevel()+1)},e.prototype.ZoomOut=function(){this.mapService.Map.setLevel(this.mapService.Map.getLevel()-1)},e.prototype.displayBasemapWidget=function(e){this.mouseX=e.pageX+this.offsetX,this.mouseY=e.pageY+this.offestY,this.isBasemapOpen=!0,this.isEditToolbarOpen=!1},e.prototype.displayEditToolbarWidget=function(e){this.mouseX=e.pageX+this.offsetX,this.mouseY=e.pageY+this.offestY,this.isEditToolbarOpen=!0,this.isBasemapOpen=!1},e.prototype.onBasemapGalleryOpen=function(){var e=this;this.isEditToolbarOpen=!1,setTimeout(function(){e.basemapGallery=new s.default({showArcGISBasemaps:!0,map:e.mapService.Map},e.basemapGalleryNode.nativeElement),e.basemapGallery.startup()},1)},e.prototype.onBasemapGalleryClose=function(){this.isBasemapOpen=!1},e.prototype.onEditToolbarClose=function(){this.isEditToolbarOpen=!1},e.prototype.onEditToolbarOpen=function(){this.isEditingActive=!1},r([i.ViewChild("basemapGallaryNode"),p("design:type",i.ElementRef)],e.prototype,"basemapGalleryNode",void 0),e=r([i.Component({selector:"fab-btn",templateUrl:"../app/map/fab/fab.component.html",styleUrls:["../app/map/fab/fab.css"]}),p("design:paramtypes",[n.VisualizationService,a.MapService,i.ChangeDetectorRef])],e)}(),e("FabComponent",o)}}});